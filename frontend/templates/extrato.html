{% set page_title = 'Extrato' %}
{% include 'partials/_head.html' %}

{% set initial_mes = initial_mes | default('', true) %}
{% set initial_ano = initial_ano | default('', true) %}
{% set bootstrap_state = bootstrap_state | default('info', true) %}
{% set bootstrap_message = bootstrap_message | default('Selecione o mês e o ano para visualizar o extrato mensal.') %}
{% set bootstrap_extrato = bootstrap_extrato | default(None) %}
{% set months = [
('01', 'Janeiro'),
('02', 'Fevereiro'),
('03', 'Março'),
('04', 'Abril'),
('05', 'Maio'),
('06', 'Junho'),
('07', 'Julho'),
('08', 'Agosto'),
('09', 'Setembro'),
('10', 'Outubro'),
('11', 'Novembro'),
('12', 'Dezembro')
] %}
{% set years = [
'2020', '2021', '2022', '2023', '2024',
'2025', '2026', '2027', '2028', '2029', '2030'
] %}

<body class="is-preload">

    <!-- Wrapper -->
    <div id="wrapper">

        <!-- Main -->
        <div id="main">
            <div class="inner">

                <!-- Header -->
                <header id="header">
                    <a href="#" class="logo"><strong>Extrato</strong> mensal</a>
                </header>

                <!-- Content -->
                <section>
                    <header class="main">
                        <h1>
                            Extrato
                            {% if bootstrap_extrato %}
                            <span class="extrato-period">{{ bootstrap_extrato.mes_nome }} / {{ bootstrap_extrato.ano
                                }}</span>
                            {% elif bootstrap_mes_nome and initial_ano %}
                            <span class="extrato-period">{{ bootstrap_mes_nome }} / {{ initial_ano }}</span>
                            {% endif %}
                        </h1>
                    </header>

                    <section>
                        <div class="table-wrapper">
                            <form id="extrato-form" class="row gtr-uniform form-container-narrow"
                                data-initial-mes="{{ initial_mes }}" data-initial-ano="{{ initial_ano }}">
                                <div class="col-6 col-12-mobile">
                                    <label for="mes">Mês</label>
                                    <select id="mes" name="mes" required>
                                        <option value="">Selecione</option>
                                        {% for value, label in months %}
                                        <option value="{{ value }}" {% if value==initial_mes %}selected{% endif %}>{{
                                            label }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-6 col-12-mobile">
                                    <label for="ano">Ano</label>
                                    <select id="ano" name="ano" required>
                                        <option value="">Selecione</option>
                                        {% for year in years %}
                                        <option value="{{ year }}" {% if year==initial_ano %}selected{% endif %}>{{ year
                                            }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                                <div class="col-12 text-center mt-1">
                                    <button type="submit" class="button primary">Buscar</button>
                                </div>
                            </form>
                        </div>

                        <div id="extrato-feedback" class="box extrato-feedback is-info" role="status" aria-live="polite"
                            data-bootstrap-state="{{ bootstrap_state }}"
                            data-bootstrap-message="{{ bootstrap_message }}">
                            {{ bootstrap_message }}
                        </div>
                        <div id="extrato-results" class="extrato-results" aria-live="polite" {% if bootstrap_extrato
                            %}data-bootstrap='{{ bootstrap_extrato | tojson | safe }}' {% endif %}>
                            {% if bootstrap_extrato %}
                            {% with extrato=bootstrap_extrato %}
                            {% include 'partials/_extrato_sections.html' %}
                            {% endwith %}
                            {% else %}
                            <p class="extrato-empty">Os resultados do extrato aparecerão aqui.</p>
                            {% endif %}
                        </div>
                        <noscript>
                            <p class="extrato-empty">Ative o JavaScript para consultar o extrato.</p>
                        </noscript>
                    </section>

                </section>

            </div>
        </div>

        {% include 'partials/_sidebar.html' %}

    </div>

    <script src="{{ url_for('static', filename='js/common.js', v=config.get('GIT_SHA','')) }}"></script>
    {% include 'partials/_base_scripts.html' %}
    <script src="{{ url_for('static', filename='js/extrato.js', v=config.get('GIT_SHA','')) }}"></script>

</body>

</html>